# There are two halves to identifying a CPE component.  We first must know that
# a particular software (with a known CPE id) is included in the package (or its artifacts).
# We then, secondarily, must know which Julia Package version corresponds with which upstream
# version. This configuration file specifies the ways in which this is systematically (and
# manually) populated.

# In some cases, we can systematically identify both by matching simple regular expression
# with exactly one capture group (to capture the exact version number) against the text of
# the README of the particular package (typically an autogenerated JLL).
[readme-regexes]
"https://sourceforge\.net/projects/libpng/files/libpng\d+/([^/]+)/" = "cpe:2.3:a:libpng:libpng"
"https://github\.com/libssh2/libssh2/releases/download/libssh2-([^/]+)/" = "cpe:2.3:a:libssh2:libssh2"
"https://github\.com/(?:xianyi|OpenMathLib)/OpenBLAS/releases/download/v([^/]+)/" = "cpe:2.3:a:openblas_project:openblas"
"https://github\.com/xianyi/OpenBLAS/archive/v([^.]+\.[^.]+\.[^.]+)\." = "cpe:2.3:a:openblas_project:openblas"
"https://github\.com/openssl/openssl/releases/download/openssl-([^/]+)/" = "cpe:2.3:a:openssl:openssl"
"https://www\.openssl\.org/source/openssl-([^.]+\.[^.]+\.[^.]+)\." = "cpe:2.3:a:openssl:openssl"
"https://github.com/libssh2/libssh2/releases/download/libssh2-([^/]+)/" = "cpe:2.3:a:libssh2:libssh2"

# Known problems:
# DuckDB_jll = "cpe:2.3:a:duckdb:duckdb" -- uses Git commit hashes for all its versions. Will likely have to manually generate.

# We regularly scan through newly tagged CPEs to look for matches. These are the false positives
# that can be ignored:
[unrelated-cpes]
raptor_jll = [
    "librdf:raptor", # librdf:raptor is https://librdf.org/raptor/ (Resource Description Framework), raptor_jll is https://github.com/tbronzwaer/raptor (radiative transfer)
]

# It's sometimes not possible to automatically generate find/parse this information
#  - Old versions do not list source information in their readmes at all
#  - Some upstream URLs might not be parseable with a single 1-capture-group regex
[overrides.libpng_jll."1.6.37+0"]
"cpe:2.3:a:libpng:libpng" = "1.6.37"

[overrides.libpng_jll."1.6.37+1"]
"cpe:2.3:a:libpng:libpng" = "1.6.37"

[overrides.libpng_jll."1.6.37+2"]
"cpe:2.3:a:libpng:libpng" = "1.6.37"

[overrides.libpng_jll."1.6.37+3"]
"cpe:2.3:a:libpng:libpng" = "1.6.37"
